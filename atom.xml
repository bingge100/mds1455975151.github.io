<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>DongSheng&#39;s Blog</title>
  <icon>https://www.gravatar.com/avatar/2e394ffb56f8f004acd7419b61a7c933</icon>
  <subtitle>记录点滴，不断突破</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://mds1455975151.github.io/"/>
  <updated>2018-10-24T05:15:53.440Z</updated>
  <id>https://mds1455975151.github.io/</id>
  
  <author>
    <name>DongSheng</name>
    <email>madscdpc@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hello World</title>
    <link href="https://mds1455975151.github.io/archives/4a17b156.html"/>
    <id>https://mds1455975151.github.io/archives/4a17b156.html</id>
    <published>2018-10-24T05:15:53.439Z</published>
    <updated>2018-10-24T05:15:53.440Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--><img src="/archives/f7ea3e07/zhifubao.jpg" width="50%"></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/4a17b156.html">https://mds1455975151.github.io/archives/4a17b156.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;\assets\js\APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is 
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>OpenWrt软路由系列之OpenWrt概述</title>
    <link href="https://mds1455975151.github.io/archives/858af81e.html"/>
    <id>https://mds1455975151.github.io/archives/858af81e.html</id>
    <published>2018-10-19T09:35:51.000Z</published>
    <updated>2018-10-24T05:16:10.458Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>OpenWrt软路由系列之OpenWrt概述</p></blockquote><a id="more"></a><h1 id="OpenWrt概述"><a href="#OpenWrt概述" class="headerlink" title="OpenWrt概述"></a>OpenWrt概述</h1><p>OpenWrt 可以被描述为一个嵌入式的 Linux 发行版，（主流路由器固件有 dd-wrt,tomato,openwrt三类）而不是试图建立一个单一的、静态的系统。OpenWrt的包管理提供了一个完全可写的文件系统，从应用程序供应商提供的选择和配置，并允许您自定义的设备，以适应任何应用程序。</p><p>对于开发人员，OpenWrt 是使用框架来构建应用程序，而无需建立一个完整的固件来支持；对于用户来说，这意味着其拥有完全定制的能力，可以用前所未有的方式使用该设备。</p><h1 id="OpenWrt效果展示show-time"><a href="#OpenWrt效果展示show-time" class="headerlink" title="OpenWrt效果展示show time"></a>OpenWrt效果展示show time</h1><p><img src="/archives/858af81e/01.png" alt=""><br><img src="/archives/858af81e/02.png" alt=""><br><img src="/archives/858af81e/03.png" alt=""><br><img src="/archives/858af81e/04.png" alt=""><br><img src="/archives/858af81e/05.png" alt=""></p><h1 id="选择OpenWrt的原因"><a href="#选择OpenWrt的原因" class="headerlink" title="选择OpenWrt的原因"></a>选择OpenWrt的原因</h1><ul><li>技能</li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/858af81e.html">https://mds1455975151.github.io/archives/858af81e.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      OpenWrt软路由系列之OpenWrt概述
    
    </summary>
    
      <category term="OpenWrt" scheme="https://mds1455975151.github.io/categories/OpenWrt/"/>
    
    
      <category term="OpenWrt" scheme="https://mds1455975151.github.io/tags/OpenWrt/"/>
    
      <category term="软路由" scheme="https://mds1455975151.github.io/tags/%E8%BD%AF%E8%B7%AF%E7%94%B1/"/>
    
  </entry>
  
  <entry>
    <title>歌曲之天仙子</title>
    <link href="https://mds1455975151.github.io/archives/8d5c7183.html"/>
    <id>https://mds1455975151.github.io/archives/8d5c7183.html</id>
    <published>2018-10-07T12:42:41.000Z</published>
    <updated>2018-10-24T05:15:55.042Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>歌曲之天仙子</p></blockquote><a id="more"></a><p>天仙子是《剑侠情缘》中即已产生，在2000年金山公司推出的游戏《剑侠情缘2》时对其谱曲，并作为暴机结束曲。同年，这首歌被由金庸作品《侠客行》同名电视剧采用当片尾曲及插曲。</p><p><a href="https://youtu.be/siGSp_n-fhc" target="_blank" rel="noopener">https://youtu.be/siGSp_n-fhc</a></p><p>歌词</p><p>冰雪少女入凡尘<br>西子湖畔初见睛<br>是非难解虚如影<br>一腔爱<br>一身恨<br>一缕清风<br>一丝魂<br>仗剑携酒江湖行<br>多少恩怨醉梦中<br>蓦然回首万事空<br>几重幕<br>几棵松<br>几层远峦<br>几声钟</p><p>冰雪少女入凡尘<br>西子湖畔初见睛<br>是非难解虚如影<br>一腔爱<br>一身恨<br>一缕清风<br>一丝魂<br>仗剑携酒江湖行<br>多少恩怨醉梦中<br>蓦然回首万事空<br>几重幕<br>几棵松<br>几层远峦<br>几声钟<br>几层远峦<br>几声钟</p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/8d5c7183.html">https://mds1455975151.github.io/archives/8d5c7183.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      歌曲之天仙子
    
    </summary>
    
      <category term="音乐" scheme="https://mds1455975151.github.io/categories/%E9%9F%B3%E4%B9%90/"/>
    
    
      <category term="歌曲" scheme="https://mds1455975151.github.io/tags/%E6%AD%8C%E6%9B%B2/"/>
    
      <category term="音乐" scheme="https://mds1455975151.github.io/tags/%E9%9F%B3%E4%B9%90/"/>
    
  </entry>
  
  <entry>
    <title>Open-Falcon监控H3C-ER3260G2路由器</title>
    <link href="https://mds1455975151.github.io/archives/186e54d8.html"/>
    <id>https://mds1455975151.github.io/archives/186e54d8.html</id>
    <published>2018-08-27T10:10:39.000Z</published>
    <updated>2018-10-24T05:15:54.378Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>本文讲述如何使用Open-Falcon监控H3C ER3260G2路由器信息，保证运维人员可以实时掌握路由器性能及流量使用问题。</p></blockquote><a id="more"></a><h1 id="部署Open-Falcon监控程序"><a href="#部署Open-Falcon监控程序" class="headerlink" title="部署Open-Falcon监控程序"></a>部署Open-Falcon监控程序</h1><p>参考资料：<a href="https://book.open-falcon.org/zh_0_2/usage/switch.html" target="_blank" rel="noopener">https://book.open-falcon.org/zh_0_2/usage/switch.html</a></p><p>利用<a href="https://github.com/gaochao1/swcollector" target="_blank" rel="noopener">swcollector</a>来实现对路由器、交换机设备的监控指标采集。</p><p>这里使用源码安装，起初使用二进制安装但是安装完成后程序无法启动，也没有日志信息，所以改为源码安装了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">配置go环境，可以使用以下脚本快速部署</span><br><span class="line">wget https://raw.githubusercontent.com/mds1455975151/tools/master/go/go_install.sh</span><br><span class="line">sh go_install.sh</span><br><span class="line"></span><br><span class="line">go get github.com/gaochao1/swcollector</span><br><span class="line">cd $GOPATH/src/github.com/gaochao1/swcollector</span><br><span class="line">go build</span><br><span class="line">go pack</span><br><span class="line">ls -al falcon-swcollector-4.0.6.3.tar.gz</span><br><span class="line">mkdir -p /usr/local/falcon-swcollector-4.0.6.3</span><br><span class="line">tar -zxf falcon-swcollector-4.0.6.3.tar.gz -C /usr/local/falcon-swcollector-4.0.6.3</span><br><span class="line">cd /usr/local/falcon-swcollector-4.0.6.3</span><br><span class="line">参考文档配置相关配置文件，cfg.json等</span><br><span class="line">./control start</span><br><span class="line">tail -f var/app.log</span><br><span class="line">到此为止监控程序部署就完毕了，因为还未设置路由器的snmp设置现在应该报连接错误，dashboard只有switch.Ping值</span><br></pre></td></tr></table></figure></p><h1 id="H3C路由器配置"><a href="#H3C路由器配置" class="headerlink" title="H3C路由器配置"></a>H3C路由器配置</h1><p><img src="/archives/186e54d8/01.png" alt=""></p><p>使用snmpwalk测试下snmp配置正确性，保证可以正常获取到相关信息</p><ul><li><p>首先在服务器安装snmp工具</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install net-snmp-utils snmp-libs snmp-devel snmp</span><br></pre></td></tr></table></figure></li><li><p>验证snmp配置正确性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># snmpwalk -v 2c -c public 10.1.16.1   # 路由器wan口地址</span><br><span class="line">SNMPv2-MIB::sysDescr.0 = STRING: H3C Product Version ERHMG2-MNW100-R1116</span><br><span class="line">H3C ERHMG2</span><br><span class="line">Copyright(c) 2014-2017 New H3C Technologies Co., Ltd. All rights reserved.</span><br><span class="line">SNMPv2-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.25506.1.1160</span><br><span class="line">DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (771062000) 89 days, 5:50:20.00</span><br><span class="line">SNMPv2-MIB::sysContact.0 = STRING: R&amp;D Hangzhou, New H3C Technologies Co., Ltd.</span><br><span class="line">SNMPv2-MIB::sysName.0 = STRING: H3C</span><br><span class="line">SNMPv2-MIB::sysLocation.0 = STRING: Hangzhou, China</span><br><span class="line">SNMPv2-MIB::sysServices.0 = INTEGER: 78</span><br><span class="line">SNMPv2-MIB::sysORLastChange.0 = Timeticks: (22) 0:00:00.22</span><br><span class="line">SNMPv2-MIB::sysORID.1 = OID: SNMPv2-MIB::snmpMIB</span><br><span class="line">SNMPv2-MIB::sysORID.2 = OID: TCP-MIB::tcpMIB</span><br><span class="line">SNMPv2-MIB::sysORID.3 = OID: IP-MIB::ip</span><br><span class="line">SNMPv2-MIB::sysORID.4 = OID: UDP-MIB::udpMIB</span><br><span class="line">SNMPv2-MIB::sysORID.5 = OID: SNMP-VIEW-BASED-ACM-MIB::vacmBasicGroup</span><br><span class="line">SNMPv2-MIB::sysORID.6 = OID: SNMP-FRAMEWORK-MIB::snmpFrameworkMIBCompliance</span><br><span class="line">SNMPv2-MIB::sysORID.7 = OID: SNMP-MPD-MIB::snmpMPDCompliance</span><br><span class="line">SNMPv2-MIB::sysORID.8 = OID: SNMP-USER-BASED-SM-MIB::usmMIBCompliance</span><br><span class="line">SNMPv2-MIB::sysORDescr.1 = STRING: The MIB module for SNMPv2 entities</span><br><span class="line">SNMPv2-MIB::sysORDescr.2 = STRING: The MIB module for managing TCP implementations</span><br><span class="line">SNMPv2-MIB::sysORDescr.3 = STRING: The MIB module for managing IP and ICMP implementations</span><br><span class="line">SNMPv2-MIB::sysORDescr.4 = STRING: The MIB module for managing UDP implementations</span><br><span class="line">SNMPv2-MIB::sysORDescr.5 = STRING: View-based Access Control Model for SNMP.</span><br><span class="line">SNMPv2-MIB::sysORDescr.6 = STRING: The SNMP Management Architecture MIB.</span><br><span class="line">SNMPv2-MIB::sysORDescr.7 = STRING: The MIB for Message Processing and Dispatching.</span><br><span class="line">SNMPv2-MIB::sysORDescr.8 = STRING: The management information definitions for the SNMP User-based Security Model.</span><br><span class="line">SNMPv2-MIB::sysORUpTime.1 = Timeticks: (21) 0:00:00.21</span><br><span class="line">SNMPv2-MIB::sysORUpTime.2 = Timeticks: (21) 0:00:00.21</span><br><span class="line">SNMPv2-MIB::sysORUpTime.3 = Timeticks: (21) 0:00:00.21</span><br><span class="line">SNMPv2-MIB::sysORUpTime.4 = Timeticks: (21) 0:00:00.21</span><br><span class="line">SNMPv2-MIB::sysORUpTime.5 = Timeticks: (21) 0:00:00.21</span><br><span class="line">SNMPv2-MIB::sysORUpTime.6 = Timeticks: (22) 0:00:00.22</span><br><span class="line">SNMPv2-MIB::sysORUpTime.7 = Timeticks: (22) 0:00:00.22</span><br><span class="line">SNMPv2-MIB::sysORUpTime.8 = Timeticks: (22) 0:00:00.22</span><br><span class="line">IF-MIB::ifNumber.0 = INTEGER: 7</span><br><span class="line">................................省略</span><br></pre></td></tr></table></figure></li></ul><h1 id="检查并验证监控信息"><a href="#检查并验证监控信息" class="headerlink" title="检查并验证监控信息"></a>检查并验证监控信息</h1><p>打开dashboard查看路由器的相关信息<br><img src="/archives/186e54d8/02.png" alt=""><br><img src="/archives/186e54d8/03.png" alt=""></p><p>另外如果开启http 可以查看web界面 <a href="http://10.1.16.151:1989/" target="_blank" rel="noopener">http://10.1.16.151:1989/</a><br><img src="/archives/186e54d8/04.png" alt=""></p><h1 id="配置监控模板及设置报警规则"><a href="#配置监控模板及设置报警规则" class="headerlink" title="配置监控模板及设置报警规则"></a>配置监控模板及设置报警规则</h1><p>省略</p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="https://www.cnblogs.com/lei0213/p/8868080.html" target="_blank" rel="noopener">centos7之zabbix的监控H3C ER3200G2流量</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/186e54d8.html">https://mds1455975151.github.io/archives/186e54d8.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Open-Falcon监控H3C ER3260G2路由器
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Open-Falcon" scheme="https://mds1455975151.github.io/tags/Open-Falcon/"/>
    
      <category term="H3C ER3260G2" scheme="https://mds1455975151.github.io/tags/H3C-ER3260G2/"/>
    
  </entry>
  
  <entry>
    <title>基于Consul+upsync构建动态Nginx配置系统</title>
    <link href="https://mds1455975151.github.io/archives/c92739f9.html"/>
    <id>https://mds1455975151.github.io/archives/c92739f9.html</id>
    <published>2018-08-06T03:29:49.000Z</published>
    <updated>2018-10-24T05:15:54.879Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>基于Consul+upsync构建动态Nginx配置系统</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本文介绍如何利用Consul+upsync来实现动态的管理Nginx后端服务器，实现动态增删后端服务器而无需reload Nginx服务。</p><h1 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h1><table><thead><tr><th>IP</th><th>os</th><th>role</th><th>remark</th></tr></thead><tbody><tr><td>192.168.200.101</td><td>CentOS 7.4</td><td>nginx-lb and consul</td><td></td></tr><tr><td>192.168.200.102</td><td>CentOS 7.4</td><td>nginx-server</td><td></td></tr><tr><td>192.168.200.103</td><td>CentOS 7.4</td><td>nginx-server</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># cat /etc/redhat-release</span><br><span class="line">CentOS Linux release 7.2.1511 (Core)</span><br><span class="line"># uname -r</span><br><span class="line">3.10.0-327.el7.x86_64</span><br><span class="line"># uname -m</span><br><span class="line">x86_64</span><br><span class="line"># nginx -V</span><br><span class="line">nginx version: nginx/1.14.0</span><br><span class="line">built by gcc 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC)</span><br><span class="line">built with OpenSSL 1.0.2k-fips  26 Jan 2017</span><br><span class="line">TLS SNI support enabled</span><br><span class="line">configure arguments: --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-compat --with-file-aio --with-threads --with-http_addition_module --with-http_auth_request_module --with-http_dav_module --with-http_flv_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_mp4_module --with-http_random_index_module --with-http_realip_module --with-http_secure_link_module --with-http_slice_module --with-http_ssl_module --with-http_stub_status_module --with-http_sub_module --with-http_v2_module --with-mail --with-mail_ssl_module --with-stream --with-stream_realip_module --with-stream_ssl_module --with-stream_ssl_preread_module --with-cc-opt=&apos;-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -fPIC&apos; --with-ld-opt=&apos;-Wl,-z,relro -Wl,-z,now -pie&apos; --add-module=/data0/src/nginx_upstream_check_module --add-module=/data0/src/nginx-upsync-module</span><br><span class="line"># consul version</span><br><span class="line">Consul v1.2.2</span><br><span class="line">Protocol 2 spoken by default, understands 2 to 3 (agent will automatically use protocol &gt;2 when speaking to compatible agents)</span><br></pre></td></tr></table></figure><h1 id="Nginx-Server安装"><a href="#Nginx-Server安装" class="headerlink" title="Nginx-Server安装"></a>Nginx-Server安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># yum install -y pcre-devel openssl-devel</span><br><span class="line"># cat /etc/yum.repos.d/nginx.repo</span><br><span class="line">[nginx]</span><br><span class="line">name=nginx repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/7/$basearch/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"># yum install -y nginx</span><br><span class="line"># systemctl start nginx</span><br><span class="line"># systemctl enable nginx</span><br><span class="line"># echo &quot;linux-node03.example.com:192.168.47.102&quot; &gt;/usr/share/nginx/html/index.html</span><br><span class="line"># echo &quot;linux-node04.example.com:192.168.47.103&quot; &gt;/usr/share/nginx/html/index.html</span><br></pre></td></tr></table></figure><h1 id="Nginx-LB配置"><a href="#Nginx-LB配置" class="headerlink" title="Nginx-LB配置"></a>Nginx-LB配置</h1><h2 id="Nginx部署"><a href="#Nginx部署" class="headerlink" title="Nginx部署"></a>Nginx部署</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># yum install -y pcre-devel openssl-devel</span><br><span class="line"># cat /etc/yum.repos.d/nginx.repo</span><br><span class="line">[nginx]</span><br><span class="line">name=nginx repo</span><br><span class="line">baseurl=http://nginx.org/packages/centos/7/$basearch/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"># yum install -y nginx</span><br><span class="line"># systemctl start nginx</span><br><span class="line"># systemctl enable nginx</span><br></pre></td></tr></table></figure><h2 id="nginx-upsync-module及nginx-upstream-check-module模块配置"><a href="#nginx-upsync-module及nginx-upstream-check-module模块配置" class="headerlink" title="nginx-upsync-module及nginx_upstream_check_module模块配置"></a>nginx-upsync-module及nginx_upstream_check_module模块配置</h2><p>upsync是微博开源的基于nginx的动态流量管理方案. github地址: <a href="https://github.com/weibocom/nginx-upsync-module" target="_blank" rel="noopener">https://github.com/weibocom/nginx-upsync-module</a>.</p><p>nginx-upsync-module，它的功能是拉取consul的后端server的列表，并更新Nginx的路由信息。此模块不依赖于任何第三方模块。 consul作为Nginx的db，利用consul的KV服务，每个Nginx work进程独立的去拉取各个upstream 的配置，并更新各自的路由。<br><img src="/archives/c92739f9/list_update.bmp" alt=""></p><p>模块相关信息可以参考GitHub文档信息：<a href="https://github.com/weibocom/nginx-upsync-module/tree/master/doc" target="_blank" rel="noopener">https://github.com/weibocom/nginx-upsync-module/tree/master/doc</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cd /data0/src</span><br><span class="line">git clone https://github.com/weibocom/nginx-upsync-module.git</span><br><span class="line">git clone https://github.com/xiaokai-wang/nginx_upstream_check_module.git</span><br><span class="line">wget http://nginx.org/download/nginx-1.14.0.tar.gz</span><br><span class="line">tar -zxf nginx-1.14.0.tar.gz</span><br><span class="line">cd nginx-1.14.0</span><br><span class="line">patch -p1 &lt; /data0/src/nginx_upstream_check_module/check_1.12.1+.patch</span><br><span class="line">./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-compat --with-file-aio --with-threads --with-http_addition_module --with-http_auth_request_module --with-http_dav_module --with-http_flv_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_mp4_module --with-http_random_index_module --with-http_realip_module --with-http_secure_link_module --with-http_slice_module --with-http_ssl_module --with-http_stub_status_module --with-http_sub_module --with-http_v2_module --with-mail --with-mail_ssl_module --with-stream --with-stream_realip_module --with-stream_ssl_module --with-stream_ssl_preread_module --with-cc-opt=&apos;-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -fPIC&apos; --with-ld-opt=&apos;-Wl,-z,relro -Wl,-z,now -pie&apos; --add-module=/data0/src/nginx_upstream_check_module --add-module=/data0/src/nginx-upsync-module</span><br><span class="line">make</span><br><span class="line">which nginx</span><br><span class="line">cp /usr/sbin/nginx&#123;,.20180804&#125;</span><br><span class="line">systemctl stop nginx</span><br><span class="line">cp /data0/src/nginx-1.14.0/objs/nginx /usr/sbin/</span><br><span class="line">systemctl start ngin</span><br><span class="line">nginx -V</span><br></pre></td></tr></table></figure><h1 id="Consul配置"><a href="#Consul配置" class="headerlink" title="Consul配置"></a>Consul配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /data0/src/</span><br><span class="line">wget https://releases.hashicorp.com/consul/1.2.2/consul_1.2.2_linux_amd64.zip</span><br><span class="line">unzip /data0/src/consul_1.2.2_linux_amd64.zip</span><br><span class="line">install /data0/src/consul /usr/local/bin/</span><br><span class="line">mkdir -p /data0/consul/&#123;data,logs&#125;</span><br><span class="line">consul agent --server --bind=192.168.200.101 --data-dir=/data0/consule/data -bootstrap-expect=1 -node=nginx-lb -client 0.0.0.0 -ui</span><br></pre></td></tr></table></figure><h1 id="调整Nginx配置并测试"><a href="#调整Nginx配置并测试" class="headerlink" title="调整Nginx配置并测试"></a>调整Nginx配置并测试</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"># cat /etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line">user  nginx;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">error_log  /var/log/nginx/error.log warn;</span><br><span class="line">pid        /var/run/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       /etc/nginx/mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class="line"></span><br><span class="line">    access_log  /var/log/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    include /etc/nginx/conf.d/*.conf;</span><br><span class="line"></span><br><span class="line">    upstream test &#123;</span><br><span class="line">        server 127.0.0.1:11111;</span><br><span class="line">        upsync 192.168.200.101:8500/v1/kv/upstreams/test upsync_timeout=6m upsync_interval=500ms upsync_type=consul strong_dependency=off;</span><br><span class="line">        upsync_dump_path /etc/nginx/server/server.conf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    upstream bar &#123;</span><br><span class="line">        server 192.168.200.102:80 weight=1 fail_timeout=10 max_fails=3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line"></span><br><span class="line">        location = / &#123;</span><br><span class="line">        proxy_pass http://test;</span><br><span class="line">          proxy_set_header  Host  $host;</span><br><span class="line">          proxy_set_header  X-Real-IP  $remote_addr;</span><br><span class="line">          proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;</span><br><span class="line">          add_header    real $upstream_addr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location ~ /Content|Scripts/ &#123;</span><br><span class="line">          proxy_pass http://test;</span><br><span class="line">          proxy_set_header  Host  $host;</span><br><span class="line">          proxy_set_header  X-Real-IP  $remote_addr;</span><br><span class="line">          proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location = /bar &#123;</span><br><span class="line">            proxy_pass http://bar;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location = /upstream_show &#123;</span><br><span class="line">            upstream_show;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location = /upstream_status &#123;</span><br><span class="line">            stub_status on;</span><br><span class="line">            access_log off;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建upsync_dump_path<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/nginx/server/</span><br></pre></td></tr></table></figure></p><h2 id="添加后端"><a href="#添加后端" class="headerlink" title="添加后端"></a>添加后端</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT http://192.168.200.101:8500/v1/kv/upstreams/test/192.168.200.102:80</span><br><span class="line">curl -X PUT http://192.168.200.101:8500/v1/kv/upstreams/test/192.168.200.103:80</span><br></pre></td></tr></table></figure><h2 id="查看通过consul添加的后端服务器信息"><a href="#查看通过consul添加的后端服务器信息" class="headerlink" title="查看通过consul添加的后端服务器信息"></a>查看通过consul添加的后端服务器信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># cat /etc/nginx/server/server.conf</span><br><span class="line">server 192.168.200.103:80 weight=1 max_fails=2 fail_timeout=10s;</span><br><span class="line">server 192.168.200.102:80 weight=1 max_fails=2 fail_timeout=10s;</span><br></pre></td></tr></table></figure><p><img src="/archives/c92739f9/03.png" alt=""></p><h2 id="验证nginx代理信息"><a href="#验证nginx代理信息" class="headerlink" title="验证nginx代理信息"></a>验证nginx代理信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># for i in `seq 100` ;do curl -s -I http://192.168.200.101|tail -2|head -1;done</span><br><span class="line">real: 192.168.200.102:80</span><br><span class="line">real: 192.168.200.103:80</span><br><span class="line">real: 192.168.200.102:80</span><br><span class="line">real: 192.168.200.103:80</span><br><span class="line">real: 192.168.200.102:80</span><br><span class="line">real: 192.168.200.103:80</span><br><span class="line">real: 192.168.200.102:80</span><br><span class="line">real: 192.168.200.103:80</span><br><span class="line">real: 192.168.200.102:80</span><br><span class="line">real: 192.168.200.103:80</span><br><span class="line">real: 192.168.200.102:80</span><br><span class="line">real: 192.168.200.103:80</span><br></pre></td></tr></table></figure><blockquote><p>real地址就是后端服务器的地址</p></blockquote><h2 id="删除后端"><a href="#删除后端" class="headerlink" title="删除后端"></a>删除后端</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -X DELETE http://192.168.200.101:8500/v1/kv/upstreams/test/192.168.200.102:80</span><br><span class="line">curl -X DELETE http://192.168.200.101:8500/v1/kv/upstreams/test/192.168.200.103:80</span><br></pre></td></tr></table></figure><h1 id="测试并验证"><a href="#测试并验证" class="headerlink" title="测试并验证"></a>测试并验证</h1><p><img src="/archives/c92739f9/01.png" alt=""><br><img src="/archives/c92739f9/02.png" alt=""></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/c92739f9.html">https://mds1455975151.github.io/archives/c92739f9.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      基于consul+upsync构建动态Nginx配置系统
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="nginx" scheme="https://mds1455975151.github.io/tags/nginx/"/>
    
      <category term="upsync" scheme="https://mds1455975151.github.io/tags/upsync/"/>
    
      <category term="consul" scheme="https://mds1455975151.github.io/tags/consul/"/>
    
  </entry>
  
  <entry>
    <title>Jenkins之配置多jobs执行</title>
    <link href="https://mds1455975151.github.io/archives/de5dd2ef.html"/>
    <id>https://mds1455975151.github.io/archives/de5dd2ef.html</id>
    <published>2018-07-07T04:03:15.000Z</published>
    <updated>2018-10-24T05:15:53.942Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Jenkins之配置多jobs执行</p></blockquote><a id="more"></a><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>使用jenkins中，当有多个jobs需要互相关联时，就需要设置jobs的上下游关联关系。比如job_A运行后触发job_B。</p><h1 id="多jobs无关联参数"><a href="#多jobs无关联参数" class="headerlink" title="多jobs无关联参数"></a>多jobs无关联参数</h1><p>主要是上游配置及下游配置</p><h1 id="多jobs有关联参数"><a href="#多jobs有关联参数" class="headerlink" title="多jobs有关联参数"></a>多jobs有关联参数</h1><p>插件：Parameterized Trigger Plugin</p><p>场景：游戏打包及更新<br>打包项目：选择分支进行打包<br>更新项目：选择分支，选择包进行更新<br>即可以通过job关联起来，将打包的包名及分支名称传递给更新项目，简化及加快更新速度。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/de5dd2ef.html">https://mds1455975151.github.io/archives/de5dd2ef.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Jenkins之配置多jobs执行
    
    </summary>
    
      <category term="jenkins" scheme="https://mds1455975151.github.io/categories/jenkins/"/>
    
    
      <category term="jenkins" scheme="https://mds1455975151.github.io/tags/jenkins/"/>
    
      <category term="多jobs" scheme="https://mds1455975151.github.io/tags/%E5%A4%9Ajobs/"/>
    
      <category term="并行" scheme="https://mds1455975151.github.io/tags/%E5%B9%B6%E8%A1%8C/"/>
    
      <category term="串行" scheme="https://mds1455975151.github.io/tags/%E4%B8%B2%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>Git之镜像仓库全攻略</title>
    <link href="https://mds1455975151.github.io/archives/177a4e8b.html"/>
    <id>https://mds1455975151.github.io/archives/177a4e8b.html</id>
    <published>2018-07-07T04:01:41.000Z</published>
    <updated>2018-10-24T05:15:53.378Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Git镜像仓库应用全攻略指南</p></blockquote><a id="more"></a><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>以下案例以GitHub上的仓库作为原仓库，在国内或者公司局域网部署镜像仓库。使用<a href="https://github.com/mds1455975151/ansible-role-pip.git仓库作为原仓库。" target="_blank" rel="noopener">https://github.com/mds1455975151/ansible-role-pip.git仓库作为原仓库。</a></p><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ul><li>加速访问GitHub仓库</li><li>GitHub负载均衡(类似MySQL的读写分离架构)</li></ul><h1 id="原生git-clone-–mirror实现"><a href="#原生git-clone-–mirror实现" class="headerlink" title="原生git clone –mirror实现"></a>原生git clone –mirror实现</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># cd /opt/</span><br><span class="line"># git clone --mirror https://github.com/mds1455975151/ansible-role-pip.git</span><br><span class="line"># ls -al</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x.  4 root root 4096 Jul  7 13:31 .</span><br><span class="line">dr-xr-xr-x. 20 root root 4096 Jul  7 13:33 ..</span><br><span class="line">drwxr-xr-x   7 root root 4096 Jul  7 13:31 ansible-role-pip.git</span><br><span class="line">drwxr-xr-x.  2 root root 4096 Mar 26  2015 rh</span><br><span class="line"># git clone 10.135.95.147:/opt/ansible-role-pip.git .</span><br><span class="line">Cloning into &apos;.&apos;...</span><br><span class="line">remote: Counting objects: 181, done.</span><br><span class="line">remote: Compressing objects: 100% (77/77), done.</span><br><span class="line">remote: Total 181 (delta 75), reused 181 (delta 75)</span><br><span class="line">Receiving objects: 100% (181/181), 18.78 KiB | 0 bytes/s, done.</span><br><span class="line">Resolving deltas: 100% (75/75), done.</span><br><span class="line">[root@VM_95_147_centos tmp]# ll</span><br><span class="line">total 36</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jul  7 13:35 defaults</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jul  7 13:35 handlers</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jul  7 13:35 meta</span><br><span class="line">-rw-r--r-- 1 root root 1233 Jul  7 13:35 README.md</span><br><span class="line">-rw-r--r-- 1 root root   28 Jul  7 13:35 requirements.yml</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jul  7 13:35 tasks</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jul  7 13:35 templates</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jul  7 13:35 tests</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jul  7 13:35 vars</span><br></pre></td></tr></table></figure><h1 id="利用gogs实现"><a href="#利用gogs实现" class="headerlink" title="利用gogs实现"></a>利用gogs实现</h1><p>查看迁移和镜像仓库设置<br>1、添加迁移外部仓库<br><img src="/archives/177a4e8b/01.png" alt=""><br>2、配置克隆地址、授权信息、迁移类型等信息<br><img src="/archives/177a4e8b/02.png" alt=""><br>3、设置仓库同步频率<br><img src="/archives/177a4e8b/03.png" alt=""><br>4、配置并立即同步<br><img src="/archives/177a4e8b/04.png" alt=""></p><h1 id="利用github-mirrors实现"><a href="#利用github-mirrors实现" class="headerlink" title="利用github-mirrors实现"></a>利用github-mirrors实现</h1><p><a href="https://docs.gitlab.com/ee/workflow/repository_mirroring.html" target="_blank" rel="noopener">https://docs.gitlab.com/ee/workflow/repository_mirroring.html</a></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/177a4e8b.html">https://mds1455975151.github.io/archives/177a4e8b.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Git镜像仓库应用全攻略指南
    
    </summary>
    
      <category term="Git" scheme="https://mds1455975151.github.io/categories/Git/"/>
    
    
      <category term="mirror" scheme="https://mds1455975151.github.io/tags/mirror/"/>
    
      <category term="镜像仓库" scheme="https://mds1455975151.github.io/tags/%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93/"/>
    
      <category term="webhook" scheme="https://mds1455975151.github.io/tags/webhook/"/>
    
      <category term="gitlab-mirrors" scheme="https://mds1455975151.github.io/tags/gitlab-mirrors/"/>
    
      <category term="gogs" scheme="https://mds1455975151.github.io/tags/gogs/"/>
    
  </entry>
  
  <entry>
    <title>CentOS安装显示器黑屏解决</title>
    <link href="https://mds1455975151.github.io/archives/a542927a.html"/>
    <id>https://mds1455975151.github.io/archives/a542927a.html</id>
    <published>2018-04-27T07:29:17.000Z</published>
    <updated>2018-10-24T05:15:53.103Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>CentOS安装显示器黑屏解决</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>办公室有一台闲置台式机，重做系统安装CentOS做测试机器，安装过程显示器黑屏。</p><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><p>显示器型号：Dell E2214Hv<br>报错信息如下：<br><img src="/archives/a542927a/01.jpg" alt=""></p><h2 id="问题分析及解决办法"><a href="#问题分析及解决办法" class="headerlink" title="问题分析及解决办法"></a>问题分析及解决办法</h2><p><a href="https://www.centos.org/forums/viewtopic.php?t=23977" target="_blank" rel="noopener">https://www.centos.org/forums/viewtopic.php?t=23977</a><br>在安装界面使用tab键进行选择，添加如下参数，调整输出信号分辨率<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux resolution=1440X900</span><br></pre></td></tr></table></figure></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.centos.org/forums/viewtopic.php?t=23977" target="_blank" rel="noopener">https://www.centos.org/forums/viewtopic.php?t=23977</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/a542927a.html">https://mds1455975151.github.io/archives/a542927a.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      CentOS安装显示器黑屏解决
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="CentOS" scheme="https://mds1455975151.github.io/tags/CentOS/"/>
    
      <category term="黑屏" scheme="https://mds1455975151.github.io/tags/%E9%BB%91%E5%B1%8F/"/>
    
  </entry>
  
  <entry>
    <title>Linux如何管理本地多个公私钥对</title>
    <link href="https://mds1455975151.github.io/archives/8a44594a.html"/>
    <id>https://mds1455975151.github.io/archives/8a44594a.html</id>
    <published>2018-04-26T09:58:23.000Z</published>
    <updated>2018-10-24T05:15:54.170Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Linux如何管理本地多个公私钥对</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>如何在本机统一账号下使用不同的私钥访问不同的git仓库或者其他主机？</p><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><ul><li><p>新增ssh的配置文件，并修改权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch ~/.ssh/config</span><br><span class="line">chmod 600 ~/.ssh/config</span><br></pre></td></tr></table></figure></li><li><p>配置内容如下(还有别名，端口等参数)：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Host *.xxxxxx.xxx</span><br><span class="line">    IdentityFile ~/.ssh/xxxxxxxx</span><br><span class="line">    User xxxxx</span><br><span class="line"></span><br><span class="line">Host github.com</span><br><span class="line">    IdentityFile ~/.ssh/id_rsa_for_github</span><br><span class="line">    User git</span><br></pre></td></tr></table></figure></li><li><p>这样配置后就可以不用-i选项来指定私钥了</p></li></ul><h1 id="如果同一主机不同项目使用私钥不同，目前还不知道如何解决"><a href="#如果同一主机不同项目使用私钥不同，目前还不知道如何解决" class="headerlink" title="如果同一主机不同项目使用私钥不同，目前还不知道如何解决?"></a>如果同一主机不同项目使用私钥不同，目前还不知道如何解决?</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval &quot;$(ssh-agent -s)&quot;</span><br><span class="line">ssh-add ~/.ssh/key1</span><br><span class="line">ssh-add ~/.ssh/key2</span><br></pre></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/8a44594a.html">https://mds1455975151.github.io/archives/8a44594a.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Linux如何管理本地多个公私钥对
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Linux" scheme="https://mds1455975151.github.io/tags/Linux/"/>
    
      <category term="多个公私钥对" scheme="https://mds1455975151.github.io/tags/%E5%A4%9A%E4%B8%AA%E5%85%AC%E7%A7%81%E9%92%A5%E5%AF%B9/"/>
    
  </entry>
  
  <entry>
    <title>Confluence重置管理员密码</title>
    <link href="https://mds1455975151.github.io/archives/21d5abc6.html"/>
    <id>https://mds1455975151.github.io/archives/21d5abc6.html</id>
    <published>2018-04-26T04:01:43.000Z</published>
    <updated>2018-10-24T05:15:53.179Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Confluence重置管理员密码</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>新公司之前部署的confluence、jira系统，由于相关人员离职，无法找回密码，只能想办法重置密码。</p><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><h2 id="使用MySQL存储"><a href="#使用MySQL存储" class="headerlink" title="使用MySQL存储"></a>使用MySQL存储</h2><p>思路：找到对应的数据库存储字段，直接替换为已知密码串<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> jiradb</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> cwd_user;         // 用户列表</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> cwd_membership;   // 用户权限关系表</span><br><span class="line"></span><br><span class="line">// 重置密码语句 替换id内容为要重置用户的用户id</span><br><span class="line"><span class="keyword">update</span> cwd_user <span class="keyword">set</span> credential =  <span class="string">'x61Ey612Kl2gpFL56FT9weDnpSo4AV8j8+qx2AuTHdRyY036xxzTTrw10Wq3+4qQyB+XURPWx1ONxp3Y3pB37A=='</span>  <span class="keyword">where</span> <span class="keyword">id</span>=xxxxxx;</span><br><span class="line"></span><br><span class="line">// 如果你的密码是&#123;PKCS5S2&#125;前缀开头的，则用下面这个sql</span><br><span class="line"><span class="keyword">update</span> cwd_user <span class="keyword">set</span> credential =  <span class="string">'&#123;PKCS5S2&#125;ltrb9LlmZ0QDCJvktxd45WgYLOgPt2XTV8X7av2p0mhPvIwofs9bHYVz2OXQ6/kF'</span>  <span class="keyword">where</span> <span class="keyword">id</span>=xxxxx;</span><br><span class="line"></span><br><span class="line">修改后管理员密码为：Ab123456</span><br></pre></td></tr></table></figure></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.cnblogs.com/linn/p/4647327.html" target="_blank" rel="noopener">https://www.cnblogs.com/linn/p/4647327.html</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/21d5abc6.html">https://mds1455975151.github.io/archives/21d5abc6.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Confluence重置管理员密码
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Confluence" scheme="https://mds1455975151.github.io/tags/Confluence/"/>
    
  </entry>
  
  <entry>
    <title>OpenVPN最佳实践</title>
    <link href="https://mds1455975151.github.io/archives/8517c82a.html"/>
    <id>https://mds1455975151.github.io/archives/8517c82a.html</id>
    <published>2018-04-23T09:16:02.000Z</published>
    <updated>2018-10-24T05:15:54.402Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>&gt;</p><a id="more"></a><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/8517c82a.html">https://mds1455975151.github.io/archives/8517c82a.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>国外域名如何转入国内</title>
    <link href="https://mds1455975151.github.io/archives/adeb23f8.html"/>
    <id>https://mds1455975151.github.io/archives/adeb23f8.html</id>
    <published>2018-04-23T08:12:44.000Z</published>
    <updated>2018-10-24T05:15:54.868Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>国外域名如何转入国内</p></blockquote><a id="more"></a><h1 id="需求场景"><a href="#需求场景" class="headerlink" title="需求场景"></a>需求场景</h1><p>目前域名备案全国城市不支持境外注册域名，例如在godaddy注册的域名，如果购买国内的云主机的情况，如果要备案，只能转回国内。<br>那么域名能否转回国内，具体操作流程是怎样的？</p><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><p>godaddy的域名转入国内非常方便，基本上能做到10分钟就转到国内注册商。转移的过程一般流程是先解锁该域名，然后提取域名的转移码到whois邮箱。拿到域名转移码，到国内注册商（比如万网）提交域名转入。这个流程走过之后，会有个转入确认邮件发到你的域名whois邮箱。点击确认之后，再到godaddy后台释放这个域名。这样马上域名就会到国内注册商。</p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.zhihu.com/question/23014363" target="_blank" rel="noopener">https://www.zhihu.com/question/23014363</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/adeb23f8.html">https://mds1455975151.github.io/archives/adeb23f8.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      国外域名如何转入国内
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="godaddy" scheme="https://mds1455975151.github.io/tags/godaddy/"/>
    
      <category term="域名备案" scheme="https://mds1455975151.github.io/tags/%E5%9F%9F%E5%90%8D%E5%A4%87%E6%A1%88/"/>
    
  </entry>
  
  <entry>
    <title>Confluence部署实践</title>
    <link href="https://mds1455975151.github.io/archives/96133d02.html"/>
    <id>https://mds1455975151.github.io/archives/96133d02.html</id>
    <published>2018-04-23T01:51:43.000Z</published>
    <updated>2018-10-24T05:15:53.173Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Confluence部署实践</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://www.cnblogs.com/kevingrace/p/7607442.html" target="_blank" rel="noopener">https://www.cnblogs.com/kevingrace/p/7607442.html</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/96133d02.html">https://mds1455975151.github.io/archives/96133d02.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Confluence部署实践
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Confluence" scheme="https://mds1455975151.github.io/tags/Confluence/"/>
    
      <category term="wiki" scheme="https://mds1455975151.github.io/tags/wiki/"/>
    
  </entry>
  
  <entry>
    <title>CentOS禁用ipv6</title>
    <link href="https://mds1455975151.github.io/archives/7da246ab.html"/>
    <id>https://mds1455975151.github.io/archives/7da246ab.html</id>
    <published>2018-04-22T10:01:36.000Z</published>
    <updated>2018-10-24T05:15:53.132Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>CentOS禁用ipv6</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>如何禁用ipv6?</p><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><h2 id="根本解决办法"><a href="#根本解决办法" class="headerlink" title="根本解决办法"></a>根本解决办法</h2><blockquote><p>修改grub，在引导时就不加载IPV6模块</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/default/grub       // 第6行添加ipv6.disable=1参数</span></span><br><span class="line">GRUB_TIMEOUT=5</span><br><span class="line">GRUB_DISTRIBUTOR=<span class="string">"<span class="variable">$(sed 's, release .*$,,g' /etc/system-release)</span>"</span></span><br><span class="line">GRUB_DEFAULT=saved</span><br><span class="line">GRUB_DISABLE_SUBMENU=<span class="literal">true</span></span><br><span class="line">GRUB_TERMINAL_OUTPUT=<span class="string">"console"</span></span><br><span class="line">GRUB_CMDLINE_LINUX=<span class="string">"ipv6.disable=1 crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap biosdevname=0 net.ifnames=0 rhgb quiet"</span></span><br><span class="line">GRUB_DISABLE_RECOVERY=<span class="string">"true"</span></span><br><span class="line"><span class="comment"># grub2-mkconfig -o /boot/grub2/grub.cfg</span></span><br><span class="line">Generating grub configuration file ...</span><br><span class="line">Found linux image: /boot/vmlinuz-3.10.0-693.el7.x86_64</span><br><span class="line">Found initrd image: /boot/initramfs-3.10.0-693.el7.x86_64.img</span><br><span class="line">Found linux image: /boot/vmlinuz-0-rescue-02f22e022e08404a89d15e63ef1de03f</span><br><span class="line">Found initrd image: /boot/initramfs-0-rescue-02f22e022e08404a89d15e63ef1de03f.img</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># reboot</span></span><br><span class="line"><span class="comment"># lsmod|grep ipv6</span></span><br></pre></td></tr></table></figure><h2 id="修改内核参数"><a href="#修改内核参数" class="headerlink" title="修改内核参数"></a>修改内核参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># cat /proc/sys/net/ipv6/conf/all/disable_ipv6</span><br></pre></td></tr></table></figure><p><strong>If the output is 0, IPv6 is enabled.</strong><br><strong>If the output is 1, IPv6 is already disabled.</strong><br>修改前后ifconfig查看网卡信息区别<br><img src="/archives/7da246ab/01.png" alt=""><br><img src="/archives/7da246ab/02.png" alt=""><br>完整操作步骤：<br>Step 1: add this rule in /etc/sysctl.conf : net.ipv6.conf.all.disable_ipv6=1<br>Step 2: add this rule in /etc/sysconfig/network: NETWORKING_IPV6=no<br>Step 3: add this setting for each nic X (X is the corresponding number for each nic) in /etc/sysconfig/network-scripts/ifcfg-ethX: IPV6INIT=no<br>Step 4: disable the ip6tables service : chkconfig ip6tables off<br>Step 5: Reload the sysctl configuration:  sysctl -p  or reboot</p><h2 id="FQA"><a href="#FQA" class="headerlink" title="FQA"></a>FQA</h2><p>注意：禁用IPV6后，可能会导致某些服务无法启动,比如VSFTP，对于VSFTP，需要修改如下设置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line">listen=YES</span><br><span class="line">listen_ipv6=NO</span><br></pre></td></tr></table></figure></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://blog.csdn.net/bluishglc/article/details/41390785" target="_blank" rel="noopener">https://blog.csdn.net/bluishglc/article/details/41390785</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/7da246ab.html">https://mds1455975151.github.io/archives/7da246ab.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      CentOS禁用ipv6
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="CentOS" scheme="https://mds1455975151.github.io/tags/CentOS/"/>
    
      <category term="禁用IPV6" scheme="https://mds1455975151.github.io/tags/%E7%A6%81%E7%94%A8IPV6/"/>
    
  </entry>
  
  <entry>
    <title>Graylog+Elasticsearch+MongoDB+Nginx+Rsyslog日志集中收集解决方案</title>
    <link href="https://mds1455975151.github.io/archives/197f9391.html"/>
    <id>https://mds1455975151.github.io/archives/197f9391.html</id>
    <published>2018-04-22T03:30:30.000Z</published>
    <updated>2018-10-24T05:15:53.432Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Graylog+Elasticsearch+MongoDB+Nginx+Rsyslog日志集中收集解决方案</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>Graylog官网：<a href="https://www.graylog.org/" target="_blank" rel="noopener">https://www.graylog.org/</a><br>Graylog docs： <a href="https://www.graylog.org/" target="_blank" rel="noopener">https://www.graylog.org/</a><br>Graylog download：<a href="https://www.graylog.org/" target="_blank" rel="noopener">https://www.graylog.org/</a></p><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@linux-node01 ~]# cat /etc/redhat-release</span><br><span class="line">CentOS Linux release 7.4.1708 (Core)</span><br><span class="line">[root@linux-node01 ~]# uname -r</span><br><span class="line">3.10.0-693.el7.x86_64</span><br><span class="line">[root@linux-node01 ~]# uname -m</span><br><span class="line">x86_64</span><br></pre></td></tr></table></figure><h2 id="MongoDB安装"><a href="#MongoDB安装" class="headerlink" title="MongoDB安装"></a>MongoDB安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># yum install -y mongodb-*</span><br><span class="line"># grep -vE &quot;^$|^#&quot; /etc/mongod.conf</span><br><span class="line">bind_ip = 127.0.0.1</span><br><span class="line">port = 27017</span><br><span class="line">auth = true</span><br><span class="line"># systemctl enable mongod</span><br><span class="line"># systemctl start mongod</span><br><span class="line"># netstat -tunlp|grep mongod</span><br><span class="line">tcp        0      0 127.0.0.1:27017         0.0.0.0:*               LISTEN      3120/mongod</span><br><span class="line"># mongo</span><br><span class="line">MongoDB shell version: 2.6.12</span><br><span class="line">connecting to: test</span><br><span class="line">Welcome to the MongoDB shell.</span><br><span class="line">For interactive help, type &quot;help&quot;.</span><br><span class="line">For more comprehensive documentation, see</span><br><span class="line">        http://docs.mongodb.org/</span><br><span class="line">Questions? Try the support group</span><br><span class="line">        http://groups.google.com/group/mongodb-user</span><br><span class="line">Server has startup warnings:</span><br><span class="line">2018-04-22T12:08:56.915+0800 [initandlisten]</span><br><span class="line">2018-04-22T12:08:56.915+0800 [initandlisten] ** WARNING: Readahead for /var/lib/mongodb is set to 4096KB</span><br><span class="line">2018-04-22T12:08:56.915+0800 [initandlisten] **          We suggest setting it to 256KB (512 sectors) or less</span><br><span class="line">2018-04-22T12:08:56.915+0800 [initandlisten] **          http://dochub.mongodb.org/core/readahead</span><br><span class="line">&gt; use graylog2</span><br><span class="line">switched to db graylog2</span><br><span class="line">&gt; db.addUser(&quot;login&quot;,&quot;123456&quot;)</span><br><span class="line">WARNING: The &apos;addUser&apos; shell helper is DEPRECATED. Please use &apos;createUser&apos; instead</span><br><span class="line">Successfully added user: &#123; &quot;user&quot; : &quot;login&quot;, &quot;roles&quot; : [ &quot;dbOwner&quot; ] &#125;</span><br></pre></td></tr></table></figure><h2 id="JDK安装"><a href="#JDK安装" class="headerlink" title="JDK安装"></a>JDK安装</h2><blockquote><p>Graylog及Elasticsearch都需要java环境</p></blockquote><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">JDK下载地址</a>,下载jdk-8u171-linux-x64.rpm<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rpm -ivh jdk-8u171-linux-x64.rpm</span></span><br><span class="line"><span class="comment"># vim /etc/profile</span></span><br><span class="line"><span class="comment"># JAVA bin PATH setup</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_171/</span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/jre/lib/rt.jar:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"><span class="comment"># java -version</span></span><br><span class="line">java version <span class="string">"1.8.0_171"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_171-b11)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode)</span><br></pre></td></tr></table></figure></p><h2 id="Elasticsearch安装"><a href="#Elasticsearch安装" class="headerlink" title="Elasticsearch安装"></a>Elasticsearch安装</h2><p>官网地址：<a href="https://www.elastic.co/products/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/products/elasticsearch</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.2.4.rpm</span></span><br><span class="line"><span class="comment"># rpm -ivh elasticsearch-6.2.4.rpm</span></span><br><span class="line"><span class="comment"># grep -vE "^$|^#" /etc/elasticsearch/elasticsearch.yml</span></span><br><span class="line">cluster.name: graylog</span><br><span class="line"><span class="comment"># systemctl daemon-reload</span></span><br><span class="line"><span class="comment"># systemctl enable elasticsearch.service</span></span><br><span class="line"><span class="comment"># systemctl start elasticsearch.service</span></span><br><span class="line"><span class="comment">#  curl -X GET http://localhost:9200</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span> : <span class="string">"elcTqyk"</span>,</span><br><span class="line">  <span class="string">"cluster_name"</span> : <span class="string">"graylog"</span>,</span><br><span class="line">  <span class="string">"cluster_uuid"</span> : <span class="string">"NJjhhbAyToOw_6by88wG8A"</span>,</span><br><span class="line">  <span class="string">"version"</span> : &#123;</span><br><span class="line">    <span class="string">"number"</span> : <span class="string">"6.2.4"</span>,</span><br><span class="line">    <span class="string">"build_hash"</span> : <span class="string">"ccec39f"</span>,</span><br><span class="line">    <span class="string">"build_date"</span> : <span class="string">"2018-04-12T20:37:28.497551Z"</span>,</span><br><span class="line">    <span class="string">"build_snapshot"</span> : <span class="literal">false</span>,</span><br><span class="line">    <span class="string">"lucene_version"</span> : <span class="string">"7.2.1"</span>,</span><br><span class="line">    <span class="string">"minimum_wire_compatibility_version"</span> : <span class="string">"5.6.0"</span>,</span><br><span class="line">    <span class="string">"minimum_index_compatibility_version"</span> : <span class="string">"5.0.0"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"tagline"</span> : <span class="string">"You Know, for Search"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">```/</span><br><span class="line"><span class="comment">## Graylog安装</span></span><br><span class="line">&gt; 参照官网RPM安装方式，[地址](http://docs.graylog.org/en/latest/pages/installation/operating_system_packages.html)</span><br><span class="line"></span><br><span class="line">``` bash</span><br><span class="line"><span class="comment"># yum install -y pwgen</span></span><br><span class="line"><span class="comment"># pwgen -N 1 -s 96</span></span><br><span class="line">b6lQupldhq7OdH7qac7jg0ulFHgYoVqAhwDZSpmzpLwFXTWJE3o9GqLFYA4Aac2DuXlPy91VradEgQXYvVfIcWbpT2gexAUb</span><br><span class="line"><span class="comment"># yum install -y perl-Digest-SHA</span></span><br><span class="line"><span class="comment"># echo -n 123456 | shasum -a 256</span></span><br><span class="line">8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92  -</span><br><span class="line"></span><br><span class="line"><span class="comment"># rpm -Uvh https://packages.graylog2.org/repo/packages/graylog-2.4-repository_latest.rpm</span></span><br><span class="line"><span class="comment"># yum install -y graylog-server</span></span><br><span class="line"><span class="comment"># grep -vE "^$|^#" /etc/graylog/server/server.conf</span></span><br><span class="line">is_master = <span class="literal">true</span></span><br><span class="line">node_id_file = /etc/graylog/server/node-id</span><br><span class="line">root_username = admin</span><br><span class="line">root_password_sha2 = 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92</span><br><span class="line">plugin_dir = /usr/share/graylog-server/plugin</span><br><span class="line">rest_listen_uri = http://0.0.0.0:9000/api/</span><br><span class="line">rest_transport_uri = http://192.168.200.100:9000/api/</span><br><span class="line">web_listen_uri = http://0.0.0.0:9000/</span><br><span class="line">elasticsearch_hosts = http://127.0.0.1:9200</span><br><span class="line">rotation_strategy = count</span><br><span class="line">elasticsearch_max_docs_per_index = 20000000</span><br><span class="line">elasticsearch_max_number_of_indices = 20</span><br><span class="line">retention_strategy = delete</span><br><span class="line">elasticsearch_shards = 4</span><br><span class="line">elasticsearch_replicas = 0</span><br><span class="line">elasticsearch_index_prefix = graylog</span><br><span class="line">allow_leading_wildcard_searches = <span class="literal">false</span></span><br><span class="line">allow_highlighting = <span class="literal">false</span></span><br><span class="line">elasticsearch_analyzer = standard</span><br><span class="line">output_batch_size = 500</span><br><span class="line">output_flush_interval = 1</span><br><span class="line">output_fault_count_threshold = 5</span><br><span class="line">output_fault_penalty_seconds = 30</span><br><span class="line">processbuffer_processors = 5</span><br><span class="line">outputbuffer_processors = 3</span><br><span class="line">processor_wait_strategy = blocking</span><br><span class="line">ring_size = 65536</span><br><span class="line">inputbuffer_ring_size = 65536</span><br><span class="line">inputbuffer_processors = 2</span><br><span class="line">inputbuffer_wait_strategy = blocking</span><br><span class="line">message_journal_enabled = <span class="literal">true</span></span><br><span class="line">message_journal_dir = /var/lib/graylog-server/journal</span><br><span class="line">lb_recognition_period_seconds = 3</span><br><span class="line">mongodb_uri = mongodb://login:123456@localhost:27017/graylog2</span><br><span class="line">mongodb_max_connections = 1000</span><br><span class="line">mongodb_threads_allowed_to_block_multiplier = 5</span><br><span class="line">content_packs_dir = /usr/share/graylog-server/contentpacks</span><br><span class="line">content_packs_auto_load = grok-patterns.json</span><br><span class="line">proxied_requests_thread_pool_size = 32</span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl start graylog-server</span></span><br><span class="line"><span class="comment"># systemctl enable graylog-server</span></span><br></pre></td></tr></table></figure></p><h2 id="登录及测试"><a href="#登录及测试" class="headerlink" title="登录及测试"></a>登录及测试</h2><p><a href="http://192.168.200.100:9000/" target="_blank" rel="noopener">http://192.168.200.100:9000/</a><br>账号：admin<br>密码：123456</p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/197f9391.html">https://mds1455975151.github.io/archives/197f9391.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Graylog+Elasticsearch+MongoDB+Nginx+Rsyslog日志集中收集解决方案
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="日志收集" scheme="https://mds1455975151.github.io/tags/%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86/"/>
    
      <category term="Graylog" scheme="https://mds1455975151.github.io/tags/Graylog/"/>
    
  </entry>
  
  <entry>
    <title>Jenkins之实现自动构建Go项目</title>
    <link href="https://mds1455975151.github.io/archives/24256e32.html"/>
    <id>https://mds1455975151.github.io/archives/24256e32.html</id>
    <published>2018-04-20T06:20:54.000Z</published>
    <updated>2018-10-24T05:15:53.831Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Jenkins之实现自动构建Go项目</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>项目需求：实现认证服务的自动构建，项目使用Go语言实现</p><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><h2 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h2><p>[Manage Jenkins] -&gt; [Manage Plugins] -&gt; [Available] -&gt; [Go Plugin]<br><img src="/archives/24256e32/01.png" alt=""></p><blockquote><p>安装完成重启下jenkins</p></blockquote><h2 id="安装及配置Go环境"><a href="#安装及配置Go环境" class="headerlink" title="安装及配置Go环境"></a>安装及配置Go环境</h2><p><strong>安装Go环境</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar -zxvf /data0/src/go1.10.linux-amd64.tar.gz -C /usr/local</span></span><br><span class="line">cat &gt;&gt;/etc/profile&lt;&lt;EOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># Go bin PATH setup</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/go/bin</span><br><span class="line"><span class="built_in">export</span> GOPATH=<span class="string">"/data0/workspace/go"</span></span><br><span class="line">EOF</span><br><span class="line"><span class="comment"># mkdir -p /data0/workspace/go</span></span><br><span class="line"><span class="comment"># source  /etc/profile</span></span><br><span class="line"><span class="comment"># go env</span></span><br></pre></td></tr></table></figure></p><p><strong>配置Go环境</strong><br>全局工具管理–&gt;Go<br><img src="/archives/24256e32/02.png" alt=""></p><h2 id="添加构建项目"><a href="#添加构建项目" class="headerlink" title="添加构建项目"></a>添加构建项目</h2><p><strong>添加源码</strong><br><img src="/archives/24256e32/03.png" alt=""><br>默认情况下代码会checkout到$WORKSPACE/xxxx目录下，但是这样不符合Go项目的目录结构，需要将代码移动到正确的$GOPATH路径下</p><blockquote><p>$WORKSPACE/../src/github.com/xxxx/xxxx-auth</p></blockquote><p><strong>设置Go tools</strong><br><img src="/archives/24256e32/04.png" alt=""></p><p><strong>设置GOPATH</strong><br><img src="/archives/24256e32/05.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create GOPATH</span></span><br><span class="line"><span class="built_in">export</span> GOPATH=<span class="variable">$WORKSPACE</span>/..</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$GOPATH</span>:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print Go version</span></span><br><span class="line">go version</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run make to perform the build</span></span><br><span class="line">git_branch=`<span class="built_in">echo</span> <span class="variable">$&#123;GIT_BRANCH&#125;</span> |awk -F <span class="string">'/'</span> <span class="string">'&#123;print $2&#125;'</span>`</span><br><span class="line">git_commit=<span class="variable">$&#123;GIT_COMMIT:0:8&#125;</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/xxxx/xxxx-auth &amp;&amp; go build</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/xxxx/xxxx-auth &amp;&amp; tar -zcf <span class="variable">$WORKSPACE</span>/xxxx-auth-<span class="variable">$&#123;git_branch&#125;</span>-<span class="variable">$&#123;git_commit&#125;</span>-<span class="variable">$&#123;date_time&#125;</span>.tar.gz xxxx-auth configs scripts logs templates</span><br><span class="line"></span><br><span class="line">GIT_USER=`<span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/xxxx/xxxx-auth &amp;&amp; git <span class="built_in">log</span> --pretty=format:<span class="string">'%an'</span> -1`</span><br><span class="line">GIT_EMAIL=`<span class="built_in">cd</span> <span class="variable">$GOPATH</span>/src/github.com/xxxx/xxxx-auth &amp;&amp; git <span class="built_in">log</span> --pretty=format:<span class="string">'%ae'</span> -1`</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$GIT_USER</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$GIT_EMAIL</span></span><br><span class="line"><span class="keyword">if</span> [ -f profile.txt ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    rm -f profile.txt</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"GIT_USER=<span class="variable">$GIT_USER</span>"</span>&gt;profile.txt</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"GIT_EMAIL=<span class="variable">$GIT_EMAIL</span>"</span>&gt;&gt;profile.txt</span><br></pre></td></tr></table></figure></p><h2 id="检查并验证构建结果"><a href="#检查并验证构建结果" class="headerlink" title="检查并验证构建结果"></a>检查并验证构建结果</h2><p><img src="/archives/24256e32/06.png" alt=""></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="http://zpjiang.me/2017/08/09/Setup-Jenkins-for-Go-Projects/" target="_blank" rel="noopener">http://zpjiang.me/2017/08/09/Setup-Jenkins-for-Go-Projects/</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/24256e32.html">https://mds1455975151.github.io/archives/24256e32.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Jenkins之实现自动构建Go项目
    
    </summary>
    
      <category term="jenkins" scheme="https://mds1455975151.github.io/categories/jenkins/"/>
    
    
      <category term="Jenkins" scheme="https://mds1455975151.github.io/tags/Jenkins/"/>
    
      <category term="Go" scheme="https://mds1455975151.github.io/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>Go之go get与git clone区别</title>
    <link href="https://mds1455975151.github.io/archives/c008c886.html"/>
    <id>https://mds1455975151.github.io/archives/c008c886.html</id>
    <published>2018-04-20T02:24:51.000Z</published>
    <updated>2018-10-24T05:15:53.425Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><p>&gt;</p><a id="more"></a><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/c008c886.html">https://mds1455975151.github.io/archives/c008c886.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Linux之服务器修改SSH默认端口后git访问设置</title>
    <link href="https://mds1455975151.github.io/archives/bdb4d807.html"/>
    <id>https://mds1455975151.github.io/archives/bdb4d807.html</id>
    <published>2018-04-20T01:59:47.000Z</published>
    <updated>2018-10-24T05:15:54.087Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>Linux之服务器修改SSH默认端口后git访问设置</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>由于安全或者其它原因，可能会修改默认的SSH服务端口号，默认情况下，已有的git项目在pull或者push的时候会报错。<br>假设原来的项目的remote设置为git@github.com:mds1455975151/tools.git，将服务器SSH默认端口修改为4000后，导致pull或push出错。<br>报错信息如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git pull</span></span><br><span class="line">ssh: connect to host github.com port 4000: Connection timed out</span><br><span class="line">fatal: Could not <span class="built_in">read</span> from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br></pre></td></tr></table></figure></p><h1 id="实践记录"><a href="#实践记录" class="headerlink" title="实践记录"></a>实践记录</h1><h2 id="解决方案1：直接修改URL为SSH-开头"><a href="#解决方案1：直接修改URL为SSH-开头" class="headerlink" title="解决方案1：直接修改URL为SSH://开头"></a>解决方案1：直接修改URL为SSH://开头</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># git remote -v</span><br><span class="line">origin  git@github.com:mds1455975151/tools.git (fetch)</span><br><span class="line">origin  git@github.com:mds1455975151/tools.git (push)</span><br><span class="line"># git remote set-url origin ssh://git@github.com:22/mds1455975151/tools.git</span><br><span class="line"># git pull</span><br></pre></td></tr></table></figure><blockquote><p>由于修改了访问方式需要添加github的deploy key</p></blockquote><h2 id="解决方案2：修改本地配置文件"><a href="#解决方案2：修改本地配置文件" class="headerlink" title="解决方案2：修改本地配置文件"></a>解决方案2：修改本地配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat &gt;&gt;~/.ssh/config&lt;&lt;EOF</span></span><br><span class="line"></span><br><span class="line">host proxy.github.com</span><br><span class="line">   Hostname github.com</span><br><span class="line">   Port 22</span><br><span class="line">EOF</span><br><span class="line"><span class="comment"># git remote -v</span></span><br><span class="line">origin  git@github.com:mds1455975151/tools.git (fetch)</span><br><span class="line">origin  git@github.com:mds1455975151/tools.git (push)</span><br><span class="line"><span class="comment"># git remote set-url origin git@proxy.github.com:mds1455975151/tools.git</span></span><br><span class="line"><span class="comment"># git pull</span></span><br></pre></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://blog.csdn.net/yuliying/article/details/68956765" target="_blank" rel="noopener">https://blog.csdn.net/yuliying/article/details/68956765</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/bdb4d807.html">https://mds1455975151.github.io/archives/bdb4d807.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      Linux之服务器修改SSH默认端口后git访问设置
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Linux" scheme="https://mds1455975151.github.io/tags/Linux/"/>
    
      <category term="git" scheme="https://mds1455975151.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>OpenLDAP之Confluence接入设置</title>
    <link href="https://mds1455975151.github.io/archives/56a056be.html"/>
    <id>https://mds1455975151.github.io/archives/56a056be.html</id>
    <published>2018-04-19T07:48:45.000Z</published>
    <updated>2018-10-24T05:15:54.395Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>OpenLDAP之Confluence接入设置</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><p>第一步：启用OpenLDAP的memberof功能，方法参考请点击<a href="https://raw.githubusercontent.com/mds1455975151/tools/master/openldap/Enable_MemberOf.md" target="_blank" rel="noopener">这里</a></p><p>第二步：配置Confluence<br>站点管理–用户&amp;安全–用户目录–添加目录<br><img src="/archives/56a056be/1.png" alt=""><br><img src="/archives/56a056be/2.png" alt=""><br><img src="/archives/56a056be/3.png" alt=""><br><img src="/archives/56a056be/4.png" alt=""><br><img src="/archives/56a056be/5.png" alt=""><br><img src="/archives/56a056be/6.png" alt=""><br><img src="/archives/56a056be/7.png" alt=""><br><img src="/archives/56a056be/8.png" alt=""></p><p>第三步：配置组权限<br>站点管理–用户&amp;安全–全局权限<br><img src="/archives/56a056be/9.png" alt=""></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/56a056be.html">https://mds1455975151.github.io/archives/56a056be.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;OpenLDAP之Confluence接入设置&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Confluence" scheme="https://mds1455975151.github.io/tags/Confluence/"/>
    
      <category term="OpenLDAP" scheme="https://mds1455975151.github.io/tags/OpenLDAP/"/>
    
  </entry>
  
  <entry>
    <title>云数据库本地访问方法总结</title>
    <link href="https://mds1455975151.github.io/archives/5595fe34.html"/>
    <id>https://mds1455975151.github.io/archives/5595fe34.html</id>
    <published>2018-04-13T04:43:44.000Z</published>
    <updated>2018-10-24T05:15:54.756Z</updated>
    
    <content type="html"><![CDATA[<script src="\assets\js\APlayer.min.js"> </script><blockquote><p>云数据库本地访问方法总结</p></blockquote><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>越来越多的企业开始使用云数据库不在自建MySQL实例，云数据库默认没有开通公网IP地址，那本地如何连接到云数据进行日常工作呢？</p><h1 id="实践记录"><a href="#实践记录" class="headerlink" title="实践记录"></a>实践记录</h1><h2 id="使用云提供商方案"><a href="#使用云提供商方案" class="headerlink" title="使用云提供商方案"></a>使用云提供商方案</h2><p>使用云提供商解决方案，直接开通外放访问权限。<br>腾讯CDB案例：<br><img src="/archives/5595fe34/04.png" alt=""></p><h2 id="利用Navicat-for-MySQL工具实现（推荐）"><a href="#利用Navicat-for-MySQL工具实现（推荐）" class="headerlink" title="利用Navicat for MySQL工具实现（推荐）"></a>利用Navicat for MySQL工具实现（推荐）</h2><p>利用工具的SSH或者HTTP方式连接到服务器后然后跳转登录到MySQL实例<br>配置数据库登录信息<br><img src="/archives/5595fe34/01.png" alt=""><br>配置服务器的SSH登录信息<br><img src="/archives/5595fe34/02.png" alt=""><br>配置HTTP登录信息<br><img src="/archives/5595fe34/03.png" alt=""></p><h2 id="命令行登录"><a href="#命令行登录" class="headerlink" title="命令行登录"></a>命令行登录</h2><p>使用ssh转发<br><a href="https://www.cnblogs.com/hfdp/p/6089811.html" target="_blank" rel="noopener">https://www.cnblogs.com/hfdp/p/6089811.html</a><br><a href="https://segmentfault.com/a/1190000009299375" target="_blank" rel="noopener">https://segmentfault.com/a/1190000009299375</a></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://cloud.tencent.com/document/product/236/3130" target="_blank" rel="noopener">https://cloud.tencent.com/document/product/236/3130</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li>自己的网站承接广告<a href="http://www.sudianlm.com/track/c/?rid=2056" target="_blank" rel="noopener">速点广告联盟</a></li><li>广告位招商QQ:1455975151</li><li>【快来和我一起赚零花钱】 成为我的好友，入群就能每天抢红包!长按复制这条消息￥20096825￥后打开微鲤看看自动绑定，或直接输入我的邀请码 20096825 下载地址 地址 <a href="http://5dwz.cn/pIRcUJ" target="_blank" rel="noopener">http://5dwz.cn/pIRcUJ</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li>喜欢购物的朋友可以看看，<a href="http://www.1zhe.com/yq/1066027" target="_blank" rel="noopener">一折特卖</a><!--注册一折特卖，免费领集分宝，集分宝可以当钱花，免费购物不是梦，注册马上送你10集分宝。--></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/5595fe34.html">https://mds1455975151.github.io/archives/5595fe34.html</a> <br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
    
    <summary type="html">
    
      云数据库本地访问方法总结
    
    </summary>
    
      <category term="Linux运维" scheme="https://mds1455975151.github.io/categories/Linux%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="云数据库" scheme="https://mds1455975151.github.io/tags/%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="本地访问" scheme="https://mds1455975151.github.io/tags/%E6%9C%AC%E5%9C%B0%E8%AE%BF%E9%97%AE/"/>
    
  </entry>
  
</feed>
